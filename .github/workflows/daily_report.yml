# Kroky, které se provedou
steps:

  # Krok 1: Checkout kódu
  - name: Stáhnutí kódu
    uses: actions/checkout@v4

  # Krok 2: Nastavení Pythonu
  - name: Nastavení Pythonu 3.x
    uses: actions/setup-python@v5
    with:
      python-version: '3.11' # Použij moderní verzi

  # Krok 3: Instalace závislostí
  - name: Instalace knihoven
    run: |
      # Vytvoření souboru s požadavky (requests pro Telegram a GitHub)
      echo "requests" > requirements.txt
      pip install -r requirements.txt

  # Krok 4: Spuštění Python skriptu s proměnnými prostředí (Secrets)
  - name: Spuštění bota a odeslání reportu
    env:
      # Proměnné prostředí, které Python skript telegram_bot.py bude číst!
      # Zde je klíčové, že tvůj Python kód musí číst OS.ENVIRON
      BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      GITHUB_TOKEN: ${{ secrets.GITHUB_REPORT_TOKEN }}
      # Rozdělíme cestu k repozitáři na OWNER a NAME
      REPO_OWNER: ${{ secrets.REPO_FULL_PATH_OWNER }} # Budeš muset odvodit z REPO_FULL_PATH
      REPO_NAME: ${{ secrets.REPO_FULL_PATH_NAME }}
      
    run: |
      # Abychom mohli dynamicky získat REPO_OWNER a REPO_NAME z jedné proměnné,
      # musíme to provést v shellu.
      # Nejprve parsujeme celý PATH (např. JanaNovak/streamlit-app-report)
      IFS='/' read -r REPO_OWNER REPO_NAME <<< "${{ secrets.REPO_FULL_PATH }}"
      
      # Spustíme Python skript, kde použijeme tyto proměnné
      python telegram_bot.py
